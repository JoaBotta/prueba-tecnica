<div class="container">
  <h1>Crear Venta para la Barra</h1>

  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

  <div class="form-group">
    <label for="formaDePago">Forma de Pago</label>
    <select [(ngModel)]="selectedFormaDePago" name="formaDePago" id="formaDePago" class="form-control">
      <option *ngFor="let forma of formasDePago" [ngValue]="forma">{{ forma.nombre }}</option>
    </select>
  </div>

  <div class="form-group">
    <label for="producto">Producto</label>
    <select [(ngModel)]="producto" name="producto" id="producto" class="form-control">
      <option *ngFor="let producto of productos" [ngValue]="producto">{{ producto.nombre }}</option>
    </select>
  </div>

  <div class="form-group">
    <label for="cantidad">Cantidad</label>
    <input [(ngModel)]="cantidad" type="number" min="1" class="form-control" id="cantidad" />
  </div>

  <button (click)="agregarProducto()" class="btn btn-primary">Agregar Producto</button>

  <div class="mt-3">
    <h3>Productos Seleccionados</h3>
    <ul>
      <li *ngFor="let item of selectedProductos">
        {{ item.producto.nombre }} - {{ item.cantidad }} x ${{ item.producto.precioUnitario }} = ${{ item.subTotal }}
      </li>
    </ul>
    <h4>Total: ${{ totalVenta }}</h4>
  </div>

  <button (click)="crearVenta()" class="btn btn-success">Crear Venta</button>
   

  <!-- DiseÃ±o del ticket (oculto por defecto) -->
  <div id="ticket" style="display: none;">
    <h2>Ticket de Venta</h2>
    <p><strong>Barra:</strong> {{ barraId }}</p>
    <p><strong>Fecha:</strong> {{ venta?.fecha | date: 'short' }}</p>
    <p><strong>Vendedor:</strong> {{ usuario?.username }}</p>
    <h3>Productos:</h3>
    <ul>
      <li *ngFor="let item of venta?.detalleVenta">
        {{ item.productoNombre }} - {{ item.cantidad }} x ${{ item.precioUnitario }} = ${{ item.cantidad * item.precioUnitario }}
      </li>
    </ul>
    <h4>Total: ${{ venta?.total }}</h4>
    <p>Gracias por su compra.</p>
  </div>
</div>
